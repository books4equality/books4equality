<% layout( '../layout') -%>

	<style>
		.entry {
			background-color: #eee;
			border-radius: 8px;
			margin: .5em;
			padding: .5em;
		}
		
		.entry img {
			margin-bottom: 5px;
		}
		
		.reserve-book {
			padding: 5px;
			border-radius: 4px;
		}
		
		#have-account {
			margin-top: 1em;
		}
		#chartImages {
			width: 90%
		}
		#chartImages span {
			width: 20%
		} 
		#chartImages img {
			width: 20%
		}
	</style>

	<span id="organizations"><!-- id for this page so css targeting is easier -->

<h1>Organizations Page</h1>

<h3>R.E.A.D. Competition Leaderboard</h3>
<div id="chartContainer" style="height: 300px; width: 100%; margin-bottom: 2em;"></div>
<div id="chartImages"></div>

<p class="lead"><strong>Donation box Locations</strong></p>
<script src="/bower_components/handlebars/handlebars.min.js"></script>

<script id="entry-template" type="text/x-handlebars-template">
    {{#each organizations}}
        <% include ../partials/organization-template %>
    {{/each}}
</script>
<div id="results"></div>
<h3>About R.E.A.D.</h3>
<div class='jumbotron'>
	You can also <strong>start your own organization and compete for prizes</strong>. Click on enter the competition and tell us the location where you can set up a box. We will send the box to you and pick it up at the end of the semester or whenever it's full. You only need to encourage people to donate!
	<div class='demo-row row'>
		<!-- <div class='col-xs-4'> -->
		<div>
			<!-- <a class='btn btn-block btn-lg btn-info' title='Check the list of organizations' href='/organizations/login'>Enter the Competition </a> -->
			<h5>Contact us for parternship opportunities on <a href="/contact">our contact page!</a></h5>
		</div>
		<div id="have-account">
				<h6>Have an Account? <a class='btn btn-lg btn-info' title='Check the list of organizations' href='/organizations/login'>Sign in</a></h6>
		</div>
	</div>
	
	<div class="sub-section">
		<h1>Annual R.E.A.D. Competition</h1>
		<ul>
			<li>Redistributing Educational Assets Drive</li>
			<li>Competitive collection of educational resources such as textbooks and iClickers</li>
			<li>Participants are Fraternities and Sororities, chapter vs. chapter</li>
		</ul>
		<h1>R.E.A.D.</h1>
		<ul>
			<li>Chapters can collect assets for a week and a half through personal donation or solicitation</li>
			<li>Score is determined by the total monetary value of donated resources divided by number of chapter members
			<br><span class="italic">Score = Total $$ Value / Chapter Members</span></li>
		</ul>
	<h1>Competition Rules</h1>
	<ul>
		<li>Chapters sign up on a page distributed by email (Thanks Ben Quinn!)</li>
		<li>Boxes distributed to the chapters</li>
		<li>Chapters make their own goals, receive publicity for meeting the goal</li>
		<li>Winners are announced at Greek Chapter Awards, receive "grand prize"</li>
	</ul>
	</div>
</div>

	<script>
		var orgs = JSON.parse('<%- JSON.stringify(organizations) %>')
		$(function() {
			var source = $("#entry-template").html();
			var template = Handlebars.compile(source);
			$('#results').html(template({
				organizations: orgs
			}))
			data = [
				//Fake data
				{
					y: 15,
					label: 'Peter'
				}, {
					y: 15,
					label: 'Piper'
				}, {
					y: 17,
					label: 'Something'
				}, {
					y: 56,
					label: 'About'
				}, {
					y: 20,
					label: 'A Pickle'
				},
			]
			orgs.forEach((org) => {
				if(org.email !== 'books4equality@gmail.com') {
					data.push({
						y: org.numberBooks,
						label: org.name
					})
				}
			})

			data.sort((a, b) => {
				if(a.y > b.y) return -1
				if(a.y < b.y) return 1
				return 0
			})

			// Chart
			var chart = new CanvasJS.Chart("chartContainer", {

				animationEnabled: true,
				axisY: {
					title: "Books Collected"
				},
				legend: {
					verticalAlign: "bottom",
					horizontalAlign: "center"
				},
				theme: "theme1",
				data: [

					{
						type: "column",
						// showInLegend: true, 
						// legendMarkerColor: "grey",
						// legendText: "MMbbl = one million barrels",
						dataPoints: data
					}
				]
			});

			chart.render();

			// Chart images
			// orgs.forEach(org => {
			// 	if(org.logo) {
			// 		$('#chartImages').append('<span><img src="data:image/png;base64,' + org.logo.data + '" /></span>')
			// 	} else {
			// 		$('#chartImages').append('<span><p>Image not available.</p></span>')
			// 	}
			// })
		});

	</script>
	<script src='/js/libs/canvasjs.min.js'></script>
